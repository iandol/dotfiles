# This is a demo config to showcase some of the most important commands.
# It is meant to be changed and configured, as it is intentionally kept sparse.
# For a (much) more advanced configuration example see my dotfiles:
# https://github.com/FelixKratz/dotfiles

export CONFIG_DIR="$HOME/.config/sketchybar"
export PLUGIN_DIR="$CONFIG_DIR/plugins"

##### Bar Appearance #####
# Configuring the general appearance of the bar.
# These are only some of the options available. For all options see:
# https://felixkratz.github.io/SketchyBar/config/bar
# If you are looking for other colors, see the color picker:
# https://felixkratz.github.io/SketchyBar/config/tricks#color-picker

bar=(
	position=top
	height=28
	blur_radius=20
	color=0x88000000
	font_smoothing=on
	padding_left=4
	padding_right=3
	shadow=off
)
sketchybar --bar "${bar[@]}"

##### Changing Defaults #####
# We now change some default values, which are applied to all further items.
# For a full list of all available item properties see:
# https://felixkratz.github.io/SketchyBar/config/items

default=(
	padding_left=3
	padding_right=3
	icon.font="Symbols Nerd Font:Regular:18.0"
	label.font="Rec Mono Casual:Italic:13.0"
	icon.color=0xaaffffff
	label.color=0xaaffffff
	label.align=center
	icon.padding_left=3
	icon.padding_right=3
	label.padding_left=3
	label.padding_right=3
	background.color=0x44ffffff
	background.corner_radius=5
	background.height=22
	background.drawing=off
)
sketchybar --default "${default[@]}"

# ##### Aerospace Workspaces #####
sketchybar --add event aerospace_workspace_change
sketchybar --add event aerospace_mode_change

sketchybar --add item aerospace_mode left \
  --subscribe aerospace_mode aerospace_mode_change \
  --set aerospace_mode icon="󰪭" \
  icon.font.size=25 \
  script="$PLUGIN_DIR/aerospace_mode.sh" \
  icon.color=0xaa99ffcc \
  icon.padding_left=4 \
  icon.padding_right=0 \
  background.color=0x55ffeeaa \
  background.drawing=on \
  drawing=off

WORKSPACES=$(aerospace list-workspaces --all)
FOCUSED_WORKSPACE=$(aerospace list-workspaces --focused)
WORKSPACE_ITEMS=()
for WS in $WORKSPACES; do
	WORKSPACE_ITEMS+=("space.$WS")
	sketchybar --add item space.$WS left					\
		--subscribe space.$WS aerospace_workspace_change	\
		--set space.$WS										\
			label="$WS"										\
			click_script="aerospace workspace $WS"			\
			script="$PLUGIN_DIR/aerospace.sh $WS"			\
			label.padding_right=5							\
			label.padding_left=4							\
			icon.padding_left=0								\
			icon.padding_right=0
done

##### Adding Left Items #####
# We add some regular items to the left side of the bar, where
# only the properties deviating from the current defaults need to be set
sketchybar	--add item chevron left					\
			--set chevron	icon=❧					\
							label.drawing=off		\
							padding_right=0			\
							icon.padding_left=0		\
							icon.padding_right=0	\
			--add item front_app left				\
			--set front_app	icon.drawing=off		\
							padding_left=0			\
							padding_right=0			\
							script="$PLUGIN_DIR/front_app.sh" \
			--subscribe front_app front_app_switched

##### Adding Right Items #####
# In the same way as the left items we can add items to the right side.
# Additional position (e.g. center) are available, see:
# https://felixkratz.github.io/SketchyBar/config/items#adding-items-to-sketchybar

# Some items refresh on a fixed cycle, e.g. the clock runs its script once
# every 10s. Other items respond to events they subscribe to, e.g. the
# volume.sh script is only executed once an actual change in system audio
# volume is registered. More info about the event system can be found here:
# https://felixkratz.github.io/SketchyBar/config/events

sketchybar	--add item weather q							\
			--set weather	update_freq=600						\
							script="$PLUGIN_DIR/weather.sh"		\
							click_script="open -a Weather"		\
							label.max_chars=15					\
			--subscribe weather mouse.entered					\
			--add item clock right								\
			--set clock		update_freq=10						\
							icon=								\
							script="$PLUGIN_DIR/clock.sh"		\
			--add item volume right								\
			--set volume script="$PLUGIN_DIR/volume.sh"			\
			--subscribe volume volume_change					\
			--add item battery right							\
			--set battery	update_freq=120						\
							script="$PLUGIN_DIR/battery.sh"		\
			--subscribe battery system_woke power_source_change \
			--add item cpu right								\
			--set cpu	update_freq=2							\
						icon=									\
						script="$PLUGIN_DIR/cpu.sh"				\
			--subscribe volume volume_change					\
			--add item music e									\
			--set music label.color=0x66ffffff					\
						icon.color=0x66ffffff					\
						background.color=0x22ffffff				\
						label.max_chars=24						\
						scroll_texts=true						\
						label.scroll_duration=150				\
						background.padding_left=-8				\
						background.padding_right=-8				\
						icon.padding_right=0					\
						label.padding_left=1					\
						script="$PLUGIN_DIR/media.sh"			\
						click_script="/opt/homebrew/bin/media-control toggle-play-pause" \
						update_freq=15							\
						background.drawing=on					

##### Force all scripts to run the first time (never do this in a script) #####
sketchybar --update

settings:
  recursive: true
  follow-symlinks: false
  skip: ['.*', 'pandocomatic.yaml']
templates:
##############################################################################
  refs:
    setup: []
    preprocessors: []
    pandoc:
      standalone: true
      filter: 
        - 'pandoc-citeproc' #process citations
      bibliography: Core.json #JSON is faster than BibTeX
      csl: csl/apa-ian.csl
      #citation-abbreviations: cite-abbr.json
    metadata:
      notes-after-punctuation: false
      link-citations: true 
    postprocessors: []
    cleanup: []
##############################################################################
  docx:
    pandoc:
      from: markdown
      to: docx
      standalone: true
      filter:
        - 'filters/removeHR' #remove horizontal rules
        - 'filters/authorRemoveHash' #collapse down metadata "author: name: affiliation:" just to author:
        - 'filters/prependInstitute' #add affiliations if institute: metadata present
      reference-doc: 'templates/custom.docx'
      dpi: 300
##############################################################################
  docx-convert-endnote:
    extends: ['docx','refs']
    preprocessors: 
      add: ['preprocessors/convertEndnoteRefs']
##############################################################################
  docx-with-refs:
    extends: ['docx','refs']
##############################################################################
  docx-with-refs-no-links:
    extends: ['docx','refs']
    metadata: 
      link-citations: false
##############################################################################
  odt-with-refs:
    extends: ['docx-with-refs']
    pandoc:
      to: odt
      reference-doc: 'templates/custom.odt'
##############################################################################
  latex:
    preprocessors: ['preprocessors/removeAffiliations'] #LaTeX generates this from metadata unlike Word, so remove it from document for LaTeX compile
    pandoc:
      from: markdown
      to: latex
      standalone: true
      filter: 
        - filters/removeHR #remove horizontal rules
        - filters/authorToName #convert author to author: name: affiliation:
      template: templates/custom.latex
      dpi: 300
      base-header-level: 2
    metadata:
      classoption: twoside
      mainfont: 'Greta Text Pro'
      mainfontoptions: 'Numbers=OldStyle,Numbers=Proportional'
      sansfont: 'Graublau Sans'
      sansfontoptions: 'Numbers=OldStyle,Numbers=Proportional'
      monofont: 'Fira Code'
      mathfont: 'Cambria Math'
      mathfontoptions: 'math-style=ISO,bold-style=ISO'
      CJKmainfont: 'PingFang SC'
      CJKsansfont: 'Heiti SC'
      linkcolor: Mahogany
      citecolor: Sepia
      urlcolor: BrickRed
      lang: 'en-GB'
      documentclass: 'article'
      fontsize: '11pt'
      linestretch: '1.5'
      geometry: 'margin=2cm'
      nonumberfigures: true
      lof: false
    postprocessors: 'postprocessors/fixLaTeX'
##############################################################################
  latex-with-refs:
    extends: ['latex','refs']
##############################################################################
  latex-with-toc:
    extends: ['latex','refs']
    pandoc:
      table-of-contents: true
      toc-depth: 3
##############################################################################
  pdf-with-refs:
    extends: 'latex-with-refs'
    pandoc:
      to: pdf
      pdf-engine: 'xelatex'
      standalone: true
    cleanup: ['latexmk -c']
##############################################################################
# https://github.com/Wandmalfarbe/pandoc-latex-template
  eisvogel:
    extends: 'latex-with-refs'
    pandoc:
      template: templates/eisvogel.latex
      table-of-contents: true
      base-header-level: 2
    metadata: 
      titlepage: true
      titlepage-color: BB5544
      titlepage-text-color: FFFFFF
      titlepage-rule-color: FFFFFF
      titlepage-rule-height: 4
##############################################################################
  latex-ieee:
    extends: 'latex-with-refs'
    pandoc:
      template: templates/ieee.latex
    metadata: 
      fontsize: '10pt'
##############################################################################
# https://github.com/pandoc-scholar/pandoc-scholar
  latex-scholar:
    extends: 'latex-with-refs'
    pandoc:
      template: templates/pandoc-scholar.latex
    metadata: 
      fontsize: '10pt'
##############################################################################
  memoir-with-refs:
    extends: 'latex-with-refs'
    pandoc:
      template: templates/custom-memoir.latex
      table-of-contents: true
      toc-depth: 3
      base-header-level: 1
    metadata:
      documentclass: 'memoir'
######################################
  html:
    pandoc:
      from: markdown
      to: html5
      standalone: true
      number-sections: false
      section-divs: true
      mathjax: true
      filter: ['filters/removeHR'] #remove horizontal rules
      template: 'templates/custom.html'
      css: ['templates/custom.css']
      dpi: 300
      table-of-contents: false
      toc-depth: 3
      base-header-level: 1
######################################
  html-refs:
    extends: ['refs','html']
    preprocessors: ['preprocessors/convertEndnoteRefs']
######################################
  html-scholar:
    extends: ['refs','html']
    preprocessors: ['preprocessors/convertEndnoteRefs']
    pandoc:
      template: 'templates/pandoc-scholar.html'
      css: 'templates/pandoc-scholar.css'
######################################
  html-scholar-pdf:
    extends: ['html-scholar']
    pandoc:
      to: pdf
      pdf-engine: prince
      pdf-engine-opt: ['--page-size=A4','--page-margin=10mm']
######################################
  html-pdf:
    extends: ['html']
    pandoc:
      to: pdf
      pdf-engine: prince
      pdf-engine-opt: ['--page-size=A4']
######################################
  html-refs-pdf:
    extends: ['refs','html']
    preprocessors: ['preprocessors/convertEndnoteRefs']
    pandoc:
      to: pdf
      pdf-engine: prince
      pdf-engine-opt: ['--page-size=A4']
##############################################################################
  html-selfcontained:
    extends: 'html'
    pandoc:
      self-contained: true
##############################################################################
  html-with-refs:
    extends: ['refs','html']
##############################################################################
  tufte:
    pandoc:
      from: markdown
      to: html5
      section-divs: true
      standalone: true
      filter: [pandoc-sidenote]
      template: 'templates/tufte.html5'
      css: 
        - 'templates/tufte.css'
        - 'templates/tuftepandoc.css'
      self-contained: true
##############################################################################
  tufte-with-refs:
    extends: ['refs','tufte']
##############################################################################
  tufte-with-refs-pdf:
    extends: ['refs','tufte']
    pandoc:
      to: pdf
      pdf-engine: prince
      pdf-engine-opt: ['--page-size=A4']
##############################################################################
  epub:
    pandoc:
      from: markdown
      to: epub
      standalone: true
      self-contained: true
    metadata:
      stylesheet: epub.css
      cover-image: templates/VPMLogoBlack.png
##############################################################################
# VARIOUS TEST TEMPLATES
  test:
    pandoc:
      from: markdown
      to: html5
      standalone: true
      css: ['templates/custom.css']
      self-contained: true
      mathjax: true
  test-markdown:
    pandoc:
      from: markdown
      to: markdown
      output: out.md
      standalone: true
      filter: ['filters/testFilter']
    metadata:
        author: Joanna Doe
  test-pdf:
    pandoc:
      from: markdown
      to: pdf
      latex-engine: 'xelatex'
      standalone: true
    metadata: 
      lang: 'en-GB'
      papersize: 'A4' 
      documentclass: 'article'
      fontsize: '12pt'
      linestretch: '1.75'
  test-latex:
    pandoc:
      from: markdown
      to: latex
      standalone: true
    metadata: 
      lang: 'en-GB'
      papersize: 'A4' 
      documentclass: 'article'
      fontsize: '12pt'
      linestretch: '1.75'
  test-ref:
    pandoc:
      standalone: true
      filter: [pandoc-citeproc] #process citations
      bibliography: Core.json #JSON is faster than BIB
      csl: csl/apa-ian.csl
  test-docx:
    pandoc:
      from: markdown
      to: html5
      filter: 
        add: ['filters/removeHR']
  test-out:
    extends: ['test-ref','test-docx']
